{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'crypto')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'stream')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`stream`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\nimport { cookies } from 'next/headers';\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nif (!JWT_SECRET) {\n  throw new Error(\n    'JWT_SECRET environment variable is not set. ' +\n    'Please configure it before starting the application.'\n  );\n}\n\nexport interface JWTPayload {\n  userId: string;\n  email: string;\n  perfil: 'ADMIN' | 'MODERADOR';\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 10);\n}\n\nexport async function verifyPassword(\n  password: string,\n  hashedPassword: string\n): Promise<boolean> {\n  return bcrypt.compare(password, hashedPassword);\n}\n\nexport function signToken(payload: JWTPayload): string {\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: '7d' });\n}\n\nexport function verifyToken(token: string): JWTPayload | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as JWTPayload;\n  } catch {\n    return null;\n  }\n}\n\nexport async function setAuthCookie(token: string) {\n  const cookieStore = await cookies();\n  cookieStore.set('auth-token', token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    maxAge: 60 * 60 * 24 * 7, // 7 days\n    path: '/',\n  });\n}\n\nexport async function removeAuthCookie() {\n  const cookieStore = await cookies();\n  cookieStore.delete('auth-token');\n}\n\nexport async function getAuthToken(): Promise<string | undefined> {\n  const cookieStore = await cookies();\n  return cookieStore.get('auth-token')?.value;\n}\n\nexport async function getUserFromToken(): Promise<JWTPayload | null> {\n  const token = await getAuthToken();\n  if (!token) return null;\n  return verifyToken(token);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAAA;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAEzC,IAAI,CAAC,YAAY;IACf,MAAM,IAAI,MACR,iDACA;AAEJ;AAQO,eAAe,aAAa,QAAgB;IACjD,OAAO,oJAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eACpB,QAAgB,EAChB,cAAsB;IAEtB,OAAO,oJAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,SAAS,UAAU,OAAmB;IAC3C,OAAO,wJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AACzD;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,wJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,cAAc,KAAa;IAC/C,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,YAAY,GAAG,CAAC,cAAc,OAAO;QACnC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;QACvB,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,OAAO,YAAY,GAAG,CAAC,eAAe;AACxC;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB"}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\nimport { verifyToken } from './lib/auth';\n\nexport function middleware(request: NextRequest) {\n  const token = request.cookies.get('auth-token')?.value;\n  const { pathname } = request.nextUrl;\n\n  if (pathname === '/login' && token) {\n    const payload = verifyToken(token);\n    if (payload) {\n      if (payload.perfil === 'ADMIN') {\n        return NextResponse.redirect(new URL('/admin', request.url));\n      } else {\n        return NextResponse.redirect(new URL('/moderador', request.url));\n      }\n    }\n  }\n\n  if (pathname.startsWith('/admin') || pathname.startsWith('/moderador')) {\n    if (!token) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n\n    const payload = verifyToken(token);\n    if (!payload) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n\n    if (pathname.startsWith('/admin') && payload.perfil !== 'ADMIN') {\n      return NextResponse.redirect(new URL('/moderador', request.url));\n    }\n\n    if (pathname.startsWith('/moderador') && payload.perfil !== 'MODERADOR') {\n      return NextResponse.redirect(new URL('/admin', request.url));\n    }\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: ['/admin/:path*', '/moderador/:path*', '/login'],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;IACjD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,IAAI,aAAa,YAAY,OAAO;QAClC,MAAM,UAAU,IAAA,kIAAW,EAAC;QAC5B,IAAI,SAAS;YACX,IAAI,QAAQ,MAAM,KAAK,SAAS;gBAC9B,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;YAC5D,OAAO;gBACL,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;YAChE;QACF;IACF;IAEA,IAAI,SAAS,UAAU,CAAC,aAAa,SAAS,UAAU,CAAC,eAAe;QACtE,IAAI,CAAC,OAAO;YACV,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,MAAM,UAAU,IAAA,kIAAW,EAAC;QAC5B,IAAI,CAAC,SAAS;YACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,IAAI,SAAS,UAAU,CAAC,aAAa,QAAQ,MAAM,KAAK,SAAS;YAC/D,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;QAEA,IAAI,SAAS,UAAU,CAAC,iBAAiB,QAAQ,MAAM,KAAK,aAAa;YACvE,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAiB;QAAqB;KAAS;AAC3D"}}]
}